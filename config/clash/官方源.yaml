# è‡ªå·±å†™çš„ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å®˜æ–¹æºã€‚

# æœºåœºè®¢é˜…
proxy-providers:
  Airport1:
    url: "è‡ªå·±å¡«å†™"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: ğŸŸ¢ ç›´è¿

# èŠ‚ç‚¹ä¿¡æ¯
proxies:
  - { name: ğŸŸ¢ ç›´è¿, type: direct }
  - { name: ğŸ”´ æ‹’ç», type: reject }

# å…¨å±€é…ç½®
mixed-port: 7890
socks-port: 7891
port: 7892
redir-port: 7893
tproxy-port: 7894
allow-lan: true
bind-address: "*"
ipv6: true
unified-delay: true # å¼€å¯ç»Ÿä¸€å»¶è¿Ÿï¼Œä¹Ÿå°±æ˜¯çœ‹èµ·æ¥å¥½çœ‹ä¸€ç‚¹ï¼Œæ²¡ä»€ä¹ˆå®é™…ä½œç”¨
tcp-concurrent: true # å¯ç”¨ TCP å¹¶å‘è¿æ¥ï¼Œå°†ä¼šä½¿ç”¨ dns è§£æå‡ºçš„æ‰€æœ‰ IP åœ°å€è¿›è¡Œè¿æ¥ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæˆåŠŸçš„è¿æ¥
# interface-name: enp6s18
routing-mark: 6666 # æ ‡è®°å‡ºå†…æ ¸çš„æµé‡
log-level: warning
find-process-mode: "off"
global-client-fingerprint: chrome
disable-keep-alive: false
keep-alive-idle: 600
keep-alive-interval: 15
profile:
  store-selected: true
  store-fake-ip: true

# å—…æ¢
sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "+.baidu.com"
  # skip-src-address:
  #   - 192.168.0.3/32
  # skip-dst-address:
  #   - 192.168.0.3/32

# å…¥ç«™
tun:
  enable: true
  # system/gvisor/mixed
  stack: mixed
  dns-hijack:
    - any:53
    - tcp://any:53
  #ä½¿ç”¨nikkiï¼Œæ··å…¥å…¨éƒ¨ä¸ä¿®æ”¹çš„æƒ…å†µï¼Œå¼€å¯æ¥å£æŒ‡å®šä¸ºnikki
  #ä½¿ç”¨ä»…å†…æ ¸è‡ªè¡Œä¿®æ”¹ä¸‹é¢ä¸‰é¡¹ä¸ºtrue
  #device: nikki
  auto-route: false
  auto-redirect: false
  auto-detect-interface: false

# DNSæ¨¡å—
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "rule-set:private_domain,cn_domain,cn_apple_domain,cn_steam_domain"

  # ç”¨äºè§£æDNSæœåŠ¡å™¨çš„åŸŸå
  default-nameserver:
    - 223.5.5.5
  proxy-server-nameserver:
    - https://223.6.6.6/dns-query
  direct-nameserver:
    - system
    - 222.172.200.68
    - 61.166.150.123
    - 223.6.6.6
  # è¿™ä¸ªæ˜¯å…œåº•çš„
  nameserver:
    - https://8.8.8.8/dns-query
  nameserver-policy:
    "rule-set:private_domain,cn_domain,cn_apple_domain,cn_steam_domain":
      - 222.172.200.68
      - 61.166.150.123
      - 223.6.6.6
  #   # ç”¨äºå¹¿å‘Šæ‹¦æˆªï¼Œä½†æ˜¯ä¸€æ—¦è¿™æ ·è®¾ç½®ï¼Œåœ¨dnsé˜¶æ®µå°±å·²ç»è¿›è¡Œäº†æ‹¦æˆªï¼Œproxy-groups å°±æ²¡æœ‰ä½œç”¨äº†
  #   "rule-set:awavenue-ads":
  #     - rcode://success
  # fallback:
  #   - https://9.9.9.9/dns-query
  #   - https://1.0.0.1/dns-query
  #   - 8.8.4.4

  # fallback-filter:
  #   geoip: true
  #   ipcidr:
  #     - 198.18.0.0/15
  #   domain:
  #     - suffix: ".example.com"
  #     - full: "internal.company"

# å‡ºç«™ç­–ç•¥ï¼Œæ ¹æ®è‡ªå·±æƒ…å†µè°ƒæ•´æ¯ä¸ªç­–ç•¥é‡Œåˆ†ç»„æ’åºï¼Œå¢åˆ éƒ½å¯ä»¥ï¼Œæ¯”å¦‚æŠŠç¾å›½è‡ªåŠ¨æ”¾åˆ°ç¬¬ä¸€ä¸ªï¼Œæ¯”å¦‚åˆ é™¤é¦™æ¸¯æ•…è½¬ï¼Œæ³¨æ„åˆ«æ¼æ‰è¡¨æƒ…é€—å·ç­‰ã€‚
# å¦‚æœç›¸åº”åˆ†ç»„æ²¡æœ‰ç­›é€‰åˆ°å¯¹åº”çš„å›½å®¶ï¼Œè¯·æ ¹æ®è‡ªå·±èŠ‚ç‚¹åå­—è°ƒæ•´ç­›é€‰å…³é”®å­—ã€‚
# æ²¡æœ‰å†ä½¿ç”¨é”šç‚¹ï¼Œæ˜¯è€ƒè™‘å¾ˆå¤šæ–°æ‰‹ä¿®æ”¹éš¾åº¦ï¼Œè¿™æ ·æ–°æ‰‹ä¿®æ”¹æŸä¸ªåˆ†ç»„æ›´å®¹æ˜“äº›ã€‚
proxy-groups-anchor:
  policy-group:
    &policy-group {
      type: select,
      default: ğŸš€ è‡ªåŠ¨ä»£ç†,
      proxies:
        [
          ğŸš€ è‡ªåŠ¨ä»£ç†,
          â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
          â™»ï¸ å°æ¹¾è‡ªåŠ¨,
          â™»ï¸ éŸ©å›½è‡ªåŠ¨,
          â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
          â™»ï¸ ç‹®åŸè‡ªåŠ¨,
          â™»ï¸ ç¾å›½è‡ªåŠ¨,
          ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
          ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹,
          ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹,
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
          ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹,
          ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
          ğŸŒ å…¨éƒ¨èŠ‚ç‚¹,
          ğŸŸ¢ ç›´è¿,
          ğŸ”´ æ‹’ç»,
        ],
    }
  conbine-node: &conbine-node { include-all: true, type: select }
  auto: &auto { type: url-test, include-all: true, tolerance: 20, interval: 60 }
  filter:
    hk: &hk "(?i)æ¸¯|hk|hongkong|hong kong"
    tw: &tw "(?i)å°æ¹¾|æ¹¾|tw|taiwan"
    kr: &kr "(?i)éŸ©å›½|éŸ©|kr|Korean"
    jp: &jp "(?i)æ—¥|æ—¥æœ¬|jp|japan"
    sg: &sg "(?i)æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore"
    us: &us "(?i)ç¾|ç¾å›½|us|unitedstates|united states"

proxy-groups:
  - { <<: *policy-group, name: ğŸš« å¹¿å‘Šæ‹¦æˆª, default: ğŸ”´ æ‹’ç» }
  - { <<: *policy-group, name: ğŸ  æœ¬åœ°ç½‘ç»œ, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ€ Google }
  - { <<: *policy-group, name: ğŸ¤– AI, default: â™»ï¸ ç¾å›½è‡ªåŠ¨ }
  - { <<: *policy-group, name: ğŸ® Steam }
  - { <<: *policy-group, name: ğŸ‘¨ğŸ¿â€ğŸ’» GitHub }
  - { <<: *policy-group, name: ğŸ” Bing, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: â˜ï¸ OneDrive, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: â“‚ï¸ Microsoft, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ“² Telegram }
  - { <<: *policy-group, name: ğŸ¤ Twitter }
  - { <<: *policy-group, name: ğŸ“º BiliBili, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ“¹ YouTube }
  - { <<: *policy-group, name: ğŸµ TikTok }
  - { <<: *policy-group, name: ğŸ¥ NETFLIX }
  - { <<: *policy-group, name: ğŸ’¶ PayPal }
  - { <<: *policy-group, name: ğŸŸ æ¼ç½‘ä¹‹é±¼ }

  - { <<: *conbine-node, name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, filter: *hk }
  - { <<: *conbine-node, name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, filter: *tw }
  - { <<: *conbine-node, name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, filter: *kr }
  - { <<: *conbine-node, name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, filter: *jp }
  - { <<: *conbine-node, name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, filter: *sg }
  - { <<: *conbine-node, name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, filter: *us }
  - { <<: *conbine-node, name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹ }

  # - <<: { *auto, name: â™»ï¸ éæ¸¯è‡ªåŠ¨, filter: "^(?!.*(æ¸¯|HK|(?i)Hong)).*$" }
  - { <<: *auto, name: ğŸš€ è‡ªåŠ¨ä»£ç†, filter: "^(?!.*(ç›´è¿)).*$" }
  - { <<: *auto, name: â™»ï¸ é¦™æ¸¯è‡ªåŠ¨, filter: *hk }
  - { <<: *auto, name: â™»ï¸ å°æ¹¾è‡ªåŠ¨, filter: *tw }
  - { <<: *auto, name: â™»ï¸ éŸ©å›½è‡ªåŠ¨, filter: *kr }
  - { <<: *auto, name: â™»ï¸ æ—¥æœ¬è‡ªåŠ¨, filter: *jp }
  - { <<: *auto, name: â™»ï¸ ç‹®åŸè‡ªåŠ¨, filter: *sg }
  - { <<: *auto, name: â™»ï¸ ç¾å›½è‡ªåŠ¨, filter: *us }

# è§„åˆ™åŒ¹é…
# æ­¤è§„åˆ™éƒ¨åˆ†æ²¡æœ‰åšé˜²æ³„éœ²å¤„ç†ï¼Œå› ä¸ºå¼Šä¸¥é‡å¤§äºåˆ©ï¼
rules:
  - RULE-SET,awavenue_ads,ğŸš« å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,lan_ip,ğŸ  æœ¬åœ°ç½‘ç»œ,no-resolve
  - RULE-SET,private_ip,ğŸŸ¢ ç›´è¿,no-resolve
  - RULE-SET,private_domain,ğŸŸ¢ ç›´è¿
  - RULE-SET,proxylite,ğŸš€ è‡ªåŠ¨ä»£ç†
  - RULE-SET,google_domain,ğŸ€ Google
  # - RULE-SET,google_fcm_domain,ğŸŸ¢ ç›´è¿
  - RULE-SET,ai,ğŸ¤– AI
  - RULE-SET,cn_steam_domain,ğŸŸ¢ ç›´è¿
  - RULE-SET,steam_domain,ğŸ® Steam
  - RULE-SET,bilibili_domain,ğŸ“º BiliBili
  - RULE-SET,github_domain,ğŸ‘¨ğŸ¿â€ğŸ’» GitHub
  - RULE-SET,bing_domain,ğŸ” Bing
  - RULE-SET,onedrive_domain,â˜ï¸ OneDrive
  - RULE-SET,microsoft_domain,â“‚ï¸ Microsoft
  - RULE-SET,telegram_domain,ğŸ“² Telegram
  - RULE-SET,youtube_domain,ğŸ“¹ YouTube
  - RULE-SET,twitter_domain,ğŸ¤ Twitter
  - RULE-SET,cn_apple_domain,ğŸŸ¢ ç›´è¿
  - RULE-SET,tiktok_domain,ğŸµ TikTok
  - RULE-SET,netflix_domain,ğŸ¥ NETFLIX
  - RULE-SET,paypal_domain,ğŸ’¶ PayPal
  - RULE-SET,apple_ip,ğŸŸ¢ ç›´è¿,no-resolve
  - RULE-SET,google_ip,ğŸ€ Google,no-resolve
  - RULE-SET,netflix_ip,ğŸ¥ NETFLIX,no-resolve
  - RULE-SET,telegram_ip,ğŸ“² Telegram,no-resolve
  - RULE-SET,geolocation-!cn,ğŸš€ è‡ªåŠ¨ä»£ç†
  - RULE-SET,cn_domain,ğŸŸ¢ ç›´è¿
  - RULE-SET,cn_ip,ğŸŸ¢ ç›´è¿
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

# è§„åˆ™é›†
## typeï¼šå¯é€‰http/file/inline  behaviorï¼šå¯é€‰domain/ipcidr/classical formatï¼šå¯é€‰yaml/text/mrs
rule-anchor:
  ip: &ip { type: http, interval: 86400, behavior: ipcidr, format: mrs }
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }
  class: &class { type: http, interval: 86400, behavior: classical, format: text }

rule-providers:
  # è‡ªå®šä¹‰
  proxylite: { <<: *class, url: "https://raw.githubusercontent.com/qichiyuhub/rule/refs/heads/main/proxy.list" }
  lan_ip: { <<: *class, format: yaml, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/lan-ip.yaml" }
  # å¹¿å‘Š
  awavenue_ads: { <<: *domain, format: yaml, url: "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main//Filters/AWAvenue-Ads-Rule-Clash.yaml" }

  private_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/private.mrs" }
  ai: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/category-ai-!cn.mrs" }
  youtube_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/youtube.mrs" }
  google_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google.mrs" }
  # google_fcm_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/googlefcm.mrs" }
  github_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/github.mrs" }
  twitter_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/x.mrs" }
  telegram_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/telegram.mrs" }
  steam_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/steam.mrs" }
  cn_steam_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/steam@cn.mrs" }
  netflix_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/netflix.mrs" }
  bilibili_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bilibili.mrs" }
  paypal_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/paypal.mrs" }
  onedrive_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/onedrive.mrs" }
  bing_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/bing.mrs" }
  microsoft_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/microsoft.mrs" }
  cn_apple_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/apple-cn.mrs" }
  speedtest_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/ookla-speedtest.mrs" }
  tiktok_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/tiktok.mrs" }
  geolocation-!cn: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs" }
  cn_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs" }

  private_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/private.mrs" }
  cn_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs" }
  google_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/google.mrs" }
  telegram_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/telegram.mrs" }
  netflix_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/netflix.mrs" }
  apple_ip: { <<: *ip, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo-lite/geoip/apple.mrs" }
