# æœºåœºè®¢é˜…
proxy-providers:
  ğŸ›« æœºåœºè®¢é˜…:
    url: "https://a.a.a/"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 180
    proxy: DIRECT

# å…¨å±€é…ç½®
mixed-port: 7890
socks-port: 7891
port: 7892
redir-port: 7893
tproxy-port: 7894
external-controller: 127.0.0.1:9999
secret: ""
allow-lan: true
bind-address: "*"
ipv6: true
unified-delay: true # å¼€å¯ç»Ÿä¸€å»¶è¿Ÿï¼Œä¹Ÿå°±æ˜¯çœ‹èµ·æ¥å¥½çœ‹ä¸€ç‚¹ï¼Œæ²¡ä»€ä¹ˆå®é™…ä½œç”¨
tcp-concurrent: true # å¯ç”¨ TCP å¹¶å‘è¿æ¥ï¼Œå°†ä¼šä½¿ç”¨ dns è§£æå‡ºçš„æ‰€æœ‰ IP åœ°å€è¿›è¡Œè¿æ¥ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªæˆåŠŸçš„è¿æ¥
# interface-name: enp6s18
# routing-mark: 6666 # æ ‡è®°å‡ºå†…æ ¸çš„æµé‡
log-level: warning
find-process-mode: "off"
global-client-fingerprint: chrome
disable-keep-alive: false
keep-alive-idle: 600
keep-alive-interval: 15
profile:
  store-selected: true
  store-fake-ip: true

# å—…æ¢
sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.netflix.com"
    - "+.nflxvideo.net"
    - "+.amazonaws.com"
    - "+.media.dssott.com"
  skip-domain:
    - "+.apple.com"
    - "Mijia Cloud"
    - "dlg.io.mi.com"
    - "+.oray.com"
    - "+.sunlogin.net"
    - "+.push.apple.com"

# å…¥ç«™
tun:
  enable: true
  # system/gvisor/mixed
  stack: mixed
  device: utun
  dns-hijack:
    - any:53
    - tcp://any:53
  #ä½¿ç”¨nikkiï¼Œæ··å…¥å…¨éƒ¨ä¸ä¿®æ”¹çš„æƒ…å†µï¼Œå¼€å¯æ¥å£æŒ‡å®šä¸ºnikki
  #ä½¿ç”¨ä»…å†…æ ¸è‡ªè¡Œä¿®æ”¹ä¸‹é¢ä¸‰é¡¹ä¸ºtrue
  #device: nikki
  auto-route: true
  auto-redirect: true
  auto-detect-interface: true
  strict-route: true
  # è®¾ç½®ç»•è¿‡clashçš„æµé‡
  # route-exclude-address-set:
  #   - fakeip-filter
  #   - cn
  #   - private

# DNSæ¨¡å—
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  respect-rules: true
  # å¯é€‰å€¼ fake-ip/redir-hostï¼Œé»˜è®¤redir-host
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "geosite:fakeip-filter,cn,private"
    - "rule-set:direct"
    # - "geosite:apple-cn,games-cn,microsoft-cn,google-cn"

  nameserver-policy:
    # ç”¨äºå¹¿å‘Šæ‹¦æˆªï¼Œä½†æ˜¯ä¸€æ—¦è¿™æ ·è®¾ç½®
    # å°±ä¸èƒ½å¼€å¯ direct-nameserver-follow-policy: true
    # è®© direct-nameserver çš„ä¼˜å…ˆçº§é«˜äº nameserver-policy
    "rule-set:deny":
      - rcode://success
    "geosite:ads":
      - rcode://success

  # ç”¨äºè§£æDNSæœåŠ¡å™¨çš„åŸŸå
  default-nameserver:
    - https://223.6.6.6/dns-query
    - https://223.5.5.5/dns-query
    - https://1.12.12.12/dns-query
    - https://120.53.53.53/dns-query

  # ä»£ç†èŠ‚ç‚¹åŸŸåè§£ææœåŠ¡å™¨ï¼Œä»…ç”¨äºè§£æä»£ç†èŠ‚ç‚¹çš„åŸŸå
  proxy-server-nameserver:
    - https://223.6.6.6/dns-query
    - https://223.5.5.5/dns-query
    - https://1.12.12.12/dns-query
    - https://120.53.53.53/dns-query

  # direct-nameserver-follow-policy: true  # å¦‚æœä¸å¼€å¯è¿™ä¸ªé…ç½® direct-nameserver çš„ä¼˜å…ˆçº§ä¼šé«˜äº nameserver-policy
  # ç”¨äº direct å‡ºå£åŸŸåè§£æçš„ DNS æœåŠ¡å™¨
  direct-nameserver:
    - system
    - 222.172.200.68
    - 61.166.150.123
    - 223.6.6.6

  # ä¸è¦ç”¨ fallback ï¼Œåœ¨è§£æçš„æ—¶å€™ä¼šåŒæ—¶ä½¿ç”¨ nameserver å’Œ fallback ï¼Œé€ æˆDNSæ³„éœ²
  nameserver:
    - https://101.101.101.101/dns-query
    - https://101.102.103.104/dns-query
    - https://8.8.8.8/dns-query
    - https://8.8.4.4/dns-query
    - https://1.1.1.1/dns-query
    - https://1.0.0.1/dns-query

# GEOç›¸å…³è®¾ç½®
geodata-loader: memconservative
geo-auto-update: true
geo-update-interval: 12
geox-url:
  geosite: "https://accel.bigpig.online/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/geosite-all.dat"
  geoip: "https://accel.bigpig.online/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/geoip-all.metadb"
  mmdb: "https://accel.bigpig.online/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/Country-all.mmdb"
  asn: "https://accel.bigpig.online/https://github.com/DustinWin/ruleset_geodata/releases/download/mihomo-geodata/Country-ASN-all.mmdb"

proxy-groups:
  - { name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©, type: select, proxies: [â™»ï¸ è‡ªåŠ¨é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹] }
  - &auto_test { name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©, type: url-test, tolerance: 20, interval: 60, include-all: true }
  - { name: âœ‹ æ‰‹åŠ¨é€‰æ‹©, type: select, include-all: true }

  - { name: ğŸš« å¹¿å‘Š, type: select, proxies: [âŒ æ‹’ç», âœ”ï¸ ç›´è¿] } # åŸŸå
  - { name: ğŸ  æœ¬åœ°SRC, type: select, proxies: &CN [âœ”ï¸ ç›´è¿, ğŸš€ èŠ‚ç‚¹é€‰æ‹©] }
  - { name: ğŸ® æ¸¸æˆCN, type: select, proxies: *CN } # åŸŸå
  - { name: â“‚ï¸ å¾®è½¯CN, type: select, proxies: *CN } # åŸŸå
  - { name: ğŸŒˆ è°·æ­ŒCN, type: select, proxies: *CN } # åŸŸå
  - { name: ğŸ è‹¹æœCN, type: select, proxies: *CN } # åŸŸå
  - { name: ğŸ“‹ BTä¸‹è½½, type: select, proxies: *CN } # åŸŸå
  - { name: ğŸ“ˆ ç½‘ç»œæµ‹è¯•, type: select, proxies: [âœ”ï¸ ç›´è¿, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹] } # åŸŸå
  - { name: ğŸ§ª DNSæ£€æµ‹, type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âœ”ï¸ ç›´è¿, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹] } # åŸŸå
  - { name: ğŸ¤– AI!CN, type: select, proxies: &NotCN [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹] } # åŸŸå
  - { name: ğŸŒ åª’ä½“!CN, type: select, proxies: *NotCN } # åŸŸå + IP
  - { name: ğŸ•¹ï¸ æ¸¸æˆ!CN, type: select, proxies: *NotCN } # åŸŸå + IP
  - { name: ğŸ“² ç”µæŠ¥!CN, type: select, proxies: *NotCN, hidden: true } # IP
  - { name: ğŸ§± æµ·å¤–FB, type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âœ”ï¸ ç›´è¿] } # åŸŸå
  - { name: ğŸ”— å›½å†…FB, type: select, proxies: *CN } # åŸŸå + IP
  - { name: ğŸ”’ ç§æœ‰ç½‘ç»œ, type: select, proxies: [âœ”ï¸ ç›´è¿], hidden: true } # åŸŸå + IP
  - { name: ğŸŸ æ¼ç½‘ä¹‹é±¼, type: select, proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, âœ”ï¸ ç›´è¿] }
  - { name: âœ”ï¸ ç›´è¿, type: select, proxies: [DIRECT], hidden: true }
  - { name: âŒ æ‹’ç», type: select, proxies: [REJECT], hidden: true }

  - { <<: *auto_test, name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, filter: "(?i)(ğŸ‡­ğŸ‡°|æ¸¯|hk|hongkong|hong kong)" }
  - { <<: *auto_test, name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, filter: "(?i)(ğŸ‡¹ğŸ‡¼|å°|tw|taiwan|tai wan)" }
  - { <<: *auto_test, name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, filter: "(?i)(ğŸ‡°ğŸ‡·|éŸ©|kr|korean)" }
  - { <<: *auto_test, name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, filter: "(?i)(ğŸ‡¯ğŸ‡µ|æ—¥|jp|japan)" }
  - { <<: *auto_test, name: ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡èŠ‚ç‚¹, filter: "(?i)(ğŸ‡¸ğŸ‡¬|æ–°|sg|singapore)" }
  - { <<: *auto_test, name: ğŸ‡ºğŸ‡¸ ç¾å›½èŠ‚ç‚¹, filter: "(?i)(ğŸ‡ºğŸ‡¸|ç¾|us|unitedstates|united states)" }

rules:
  - RULE-SET,lanip,ğŸ  æœ¬åœ°SRC,src
  - RULE-SET,proxy,ğŸ§± æµ·å¤–FB
  - RULE-SET,direct,ğŸ”— å›½å†…FB
  - RULE-SET,dnsleak,ğŸ§ª DNSæ£€æµ‹
  - RULE-SET,deny,ğŸš« å¹¿å‘Š
  - GEOSITE,ads,ğŸš« å¹¿å‘Š
  - GEOSITE,networktest,ğŸ“ˆ ç½‘ç»œæµ‹è¯•
  - GEOSITE,private,ğŸ”’ ç§æœ‰ç½‘ç»œ
  - GEOSITE,trackerslist,ğŸ“‹ BTä¸‹è½½
  - GEOSITE,microsoft-cn,â“‚ï¸ å¾®è½¯CN
  - GEOSITE,apple-cn,ğŸ è‹¹æœCN
  - GEOSITE,google-cn,ğŸŒˆ è°·æ­ŒCN
  - GEOSITE,games-cn,ğŸ® æ¸¸æˆCN
  - GEOSITE,media,ğŸŒ åª’ä½“!CN
  - GEOSITE,games,ğŸ•¹ï¸ æ¸¸æˆ!CN
  - GEOSITE,ai,ğŸ¤– AI!CN
  - GEOSITE,tld-proxy,ğŸ§± æµ·å¤–FB
  - GEOSITE,proxy,ğŸ§± æµ·å¤–FB
  - GEOSITE,cn,ğŸ”— å›½å†…FB
  - GEOIP,privateip,ğŸ”’ ç§æœ‰ç½‘ç»œ,no-resolve
  - GEOIP,cn,ğŸ”— å›½å†…FB
  - GEOIP,media,ğŸŒ åª’ä½“!CN
  - GEOIP,games,ğŸ•¹ï¸ æ¸¸æˆ!CN
  - GEOIP,telegram,ğŸ“² ç”µæŠ¥!CN,no-resolve
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

rule-providers:
  proxy:
    &domain {
      type: http,
      interval: 86400,
      behavior: domain,
      format: yaml,
      url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/proxy.yaml",
    }
  deny: { <<: *domain, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/deny.yaml" }
  dnsleak: { <<: *domain, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/dnsleak.yaml" }
  lanip: { <<: *domain, behavior: ipcidr, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/lanip.yaml" }
  direct: { <<: *domain, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/direct.yaml" }
