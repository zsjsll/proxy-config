# æœºåœºè®¢é˜…
proxy-providers:
  Airport1:
    url: "è‡ªå·±çš„æœºåœº"
    type: http
    interval: 86400
    health-check:
      enable: true
      url: https://www.gstatic.com/generate_204
      interval: 300
    proxy: ğŸŸ¢ ç›´è¿

# èŠ‚ç‚¹ä¿¡æ¯
proxies:
  - { name: ğŸŸ¢ ç›´è¿, type: direct }
  - { name: ğŸ”´ æ‹’ç», type: reject }

# å…¨å±€é…ç½®
mixed-port: 7890
socks-port: 7891
redir-port: 7892
port: 7893
tproxy-port: 7894
allow-lan: true
bind-address: "*"
ipv6: true
unified-delay: true
tcp-concurrent: true
# interface-name: enp6s18
log-level: warning
find-process-mode: "off"
global-client-fingerprint: chrome
keep-alive-idle: 600
keep-alive-interval: 15
profile:
  store-selected: true
  store-fake-ip: true

# å—…æ¢
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "+.baidu.com"

# å…¥ç«™
tun:
  enable: true
  # system/gvisor/mixed
  stack: mixed
  dns-hijack: ["any:53", "tcp://any:53"]
  #ä½¿ç”¨nikkiï¼Œæ··å…¥å…¨éƒ¨ä¸ä¿®æ”¹çš„æƒ…å†µï¼Œå¼€å¯æ¥å£æŒ‡å®šä¸ºnikki
  #ä½¿ç”¨ä»…å†…æ ¸è‡ªè¡Œä¿®æ”¹ä¸‹é¢ä¸‰é¡¹ä¸ºtrue
  #device: nikki
  auto-route: false
  auto-redirect: false
  auto-detect-interface: false

# DNSæ¨¡å—
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: true
  respect-rules: true
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - "rule-set:private_domain,cn_domain,cn_apple_domain,cn_steam_domain,awavenue-ads"
  proxy-server-nameserver:
    - https://223.6.6.6/dns-query
  direct-nameserver:
    - 222.172.200.68
    - 61.166.150.123
    - 223.6.6.6
  # è¿™ä¸ªæ˜¯å…œåº•çš„
  nameserver:
    - https://8.8.8.8/dns-query
  nameserver-policy:
    "rule-set:private_domain,cn_domain,cn_apple_domain,cn_steam_domain":
      - 222.172.200.68
      - 61.166.150.123
      - 223.6.6.6
    # ç”¨äºå¹¿å‘Šæ‹¦æˆªï¼Œä½†æ˜¯ä¸€æ—¦è¿™æ ·è®¾ç½®ï¼Œåœ¨dnsé˜¶æ®µå°±å·²ç»è¿›è¡Œäº†æ‹¦æˆªï¼Œproxy-groups å°±æ²¡æœ‰ä½œç”¨äº†
    "rule-set:awavenue-ads":
      - rcode://success
  # fallback:
  #   - https://9.9.9.9/dns-query
  #   - https://1.0.0.1/dns-query
  #   - 8.8.4.4

  # fallback-filter:
  #   geoip: true
  #   ipcidr:
  #     - 198.18.0.0/15
  #   domain:
  #     - suffix: ".example.com"
  #     - full: "internal.company"

# å‡ºç«™ç­–ç•¥ï¼Œæ ¹æ®è‡ªå·±æƒ…å†µè°ƒæ•´æ¯ä¸ªç­–ç•¥é‡Œåˆ†ç»„æ’åºï¼Œå¢åˆ éƒ½å¯ä»¥ï¼Œæ¯”å¦‚æŠŠç¾å›½è‡ªåŠ¨æ”¾åˆ°ç¬¬ä¸€ä¸ªï¼Œæ¯”å¦‚åˆ é™¤é¦™æ¸¯æ•…è½¬ï¼Œæ³¨æ„åˆ«æ¼æ‰è¡¨æƒ…é€—å·ç­‰ã€‚
# å¦‚æœç›¸åº”åˆ†ç»„æ²¡æœ‰ç­›é€‰åˆ°å¯¹åº”çš„å›½å®¶ï¼Œè¯·æ ¹æ®è‡ªå·±èŠ‚ç‚¹åå­—è°ƒæ•´ç­›é€‰å…³é”®å­—ã€‚
# æ²¡æœ‰å†ä½¿ç”¨é”šç‚¹ï¼Œæ˜¯è€ƒè™‘å¾ˆå¤šæ–°æ‰‹ä¿®æ”¹éš¾åº¦ï¼Œè¿™æ ·æ–°æ‰‹ä¿®æ”¹æŸä¸ªåˆ†ç»„æ›´å®¹æ˜“äº›ã€‚
proxy-groups-anchor:
  policy-group:
    &policy-group {
      type: select,
      default: ğŸš€ é»˜è®¤è‡ªåŠ¨,
      proxies:
        [
          ğŸš€ é»˜è®¤è‡ªåŠ¨,
          â™»ï¸ é¦™æ¸¯è‡ªåŠ¨,
          â™»ï¸ å°æ¹¾è‡ªåŠ¨,
          â™»ï¸ éŸ©å›½è‡ªåŠ¨,
          â™»ï¸ æ—¥æœ¬è‡ªåŠ¨,
          â™»ï¸ ç‹®åŸè‡ªåŠ¨,
          â™»ï¸ ç¾å›½è‡ªåŠ¨,
          ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹,
          ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹,
          ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹,
          ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹,
          ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹,
          ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹,
          ğŸŒ å…¨éƒ¨èŠ‚ç‚¹,
          ğŸŸ¢ ç›´è¿,
          ğŸ”´ æ‹’ç»,
        ],
    }
  conbine-node: &conbine-node { include-all: true, type: select }
  auto: &auto { type: url-test, url: http://www.gstatic.com/generate_204, include-all: true, tolerance: 20, interval: 60 }
  filter:
    hk: &hk "(?i)æ¸¯|hk|hongkong|hong kong"
    tw: &tw "(?i)å°æ¹¾|æ¹¾|tw|taiwan"
    kr: &kr "(?i)éŸ©å›½|éŸ©|kr|Korean"
    jp: &jp "(?i)æ—¥|æ—¥æœ¬|jp|japan"
    sg: &sg "(?i)æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore"
    us: &us "(?i)ç¾|ç¾å›½|us|unitedstates|united states"

proxy-groups:
  - { <<: *policy-group, name: ğŸš« å¹¿å‘Šæ‹¦æˆª, default: ğŸ”´ æ‹’ç» }
  - { <<: *policy-group, name: ğŸ  æœ¬åœ°ç½‘ç»œ, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ€ Google }
  - { <<: *policy-group, name: ğŸ¤– AI, default: â™»ï¸ ç¾å›½è‡ªåŠ¨ }
  - { <<: *policy-group, name: ğŸ® Steam }
  - { <<: *policy-group, name: ğŸ‘¨ğŸ¿â€ğŸ’» GitHub }
  - { <<: *policy-group, name: ğŸ” Bing, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: â˜ï¸ OneDrive, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: â“‚ï¸ Microsoft, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ“² Telegram }
  - { <<: *policy-group, name: ğŸ¤ Twitter }
  - { <<: *policy-group, name: ğŸ“º BiliBili, default: ğŸŸ¢ ç›´è¿ }
  - { <<: *policy-group, name: ğŸ“¹ YouTube }
  - { <<: *policy-group, name: ğŸµ TikTok }
  - { <<: *policy-group, name: ğŸ¥ NETFLIX }
  - { <<: *policy-group, name: ğŸ’¶ PayPal }
  - { <<: *policy-group, name: ğŸŸ æ¼ç½‘ä¹‹é±¼ }

  - { <<: *conbine-node, name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, filter: *hk }
  - { <<: *conbine-node, name: ğŸ‡¹ğŸ‡¼ å°æ¹¾èŠ‚ç‚¹, filter: *tw }
  - { <<: *conbine-node, name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹, filter: *kr }
  - { <<: *conbine-node, name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, filter: *jp }
  - { <<: *conbine-node, name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, filter: *sg }
  - { <<: *conbine-node, name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, filter: *us }
  - { <<: *conbine-node, name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹ }

  # - <<: { *auto, name: â™»ï¸ éæ¸¯è‡ªåŠ¨, filter: "^(?!.*(æ¸¯|HK|(?i)Hong)).*$" }
  - { <<: *auto, name: ğŸš€ é»˜è®¤è‡ªåŠ¨, filter: "^(?!.*(ç›´è¿)).*$" }
  - { <<: *auto, name: â™»ï¸ é¦™æ¸¯è‡ªåŠ¨, filter: *hk }
  - { <<: *auto, name: â™»ï¸ å°æ¹¾è‡ªåŠ¨, filter: *tw }
  - { <<: *auto, name: â™»ï¸ éŸ©å›½è‡ªåŠ¨, filter: *kr }
  - { <<: *auto, name: â™»ï¸ æ—¥æœ¬è‡ªåŠ¨, filter: *jp }
  - { <<: *auto, name: â™»ï¸ ç‹®åŸè‡ªåŠ¨, filter: *sg }
  - { <<: *auto, name: â™»ï¸ ç¾å›½è‡ªåŠ¨, filter: *us }

# è§„åˆ™åŒ¹é…
# æ­¤è§„åˆ™éƒ¨åˆ†æ²¡æœ‰åšé˜²æ³„éœ²å¤„ç†ï¼Œå› ä¸ºå¼Šä¸¥é‡å¤§äºåˆ©ï¼
rules:
  - RULE-SET,awavenue-ads,ğŸš« å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,lan-ip,ğŸ  æœ¬åœ°ç½‘ç»œ
  - RULE-SET,proxylite,ğŸš€ é»˜è®¤è‡ªåŠ¨
  - GEOSITE,private,ğŸŸ¢ ç›´è¿
  - GEOSITE,google,ğŸ€ Google
  # - RULE-SET,google_fcm_domain,ğŸŸ¢ ç›´è¿
  - GEOSITE,category-ai-!cn,ğŸ¤– AI
  - GEOSITE,steam@cn,ğŸŸ¢ ç›´è¿
  - GEOSITE,steam,ğŸ® Steam
  - GEOSITE,github,ğŸ‘¨ğŸ¿â€ğŸ’» GitHub
  - GEOSITE,bing,ğŸ” Bing
  - GEOSITE,onedrive,â˜ï¸ OneDrive
  - GEOSITE,microsoft,â“‚ï¸ Microsoft
  - GEOSITE,telegram,ğŸ“² Telegram
  - GEOSITE,x,ğŸ¤ Twitter
  - GEOSITE,bilibili,ğŸ“º BiliBili
  - GEOSITE,youtube,ğŸ“¹ YouTube
  - GEOSITE,tiktok,ğŸµ TikTok
  - GEOSITE,netflix,ğŸ¥ NETFLIX
  - GEOSITE,paypal,ğŸ’¶ PayPal
  - GEOSITE,apple-cn,ğŸŸ¢ ç›´è¿
  - GEOIP,apple,ğŸŸ¢ ç›´è¿
  - GEOIP,private,ğŸŸ¢ ç›´è¿
  - GEOIP,google,ğŸ€ Google,no-resolve
  - GEOIP,netflix,ğŸ¥ NETFLIX,no-resolve
  - GEOIP,telegram,ğŸ“² Telegram,no-resolve
  - GEOIP,geolocation-!cn,ğŸš€ é»˜è®¤è‡ªåŠ¨
  - GEOSITE,cn,ğŸŸ¢ ç›´è¿
  - GEOIP,cn,ğŸŸ¢ ç›´è¿
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

# è§„åˆ™é›†
## typeï¼šå¯é€‰http/file/inline  behaviorï¼šå¯é€‰domain/ipcidr/classical formatï¼šå¯é€‰yaml/text/mrs
rule-anchor:
  ip: &ip { type: http, interval: 86400, behavior: ipcidr, format: mrs }
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }
  class: &class { type: http, interval: 86400, behavior: classical, format: text }

rule-providers:
  # è‡ªå®šä¹‰
  proxylite: { <<: *class, url: "https://raw.githubusercontent.com/qichiyuhub/rule/refs/heads/main/proxy.list" }
  lan-ip: { <<: *class, format: yaml, url: "https://raw.githubusercontent.com/zsjsll/proxy-config/refs/heads/self/rules/lan-ip.yaml" }
  # å¹¿å‘Š
  awavenue-ads: { <<: *domain, format: yaml, url: "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main//Filters/AWAvenue-Ads-Rule-Clash.yaml" }

  # google_fcm_domain: { <<: *domain, url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/googlefcm.mrs" }
